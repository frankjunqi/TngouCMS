/*
 * likedown - v1.0.0 - 2015-06-10
 * home: http://likedown.chiki.org/
 * Copyright (c) 2015 XiaoKu Inc. All Rights Reserved.
 */
+function(a){"use strict";function b(){a("pre > code").each(function(){try{!this.highlighted&&hljs.highlightBlock(this),this.highlighted=!0}catch(a){}}),a("pre > code.language-sequence").each(function(){try{var a=Diagram.parse(this.textContent),b=this.parentNode,c=document.createElement("div");c.className="sequence-diagram",b.parentNode.replaceChild(c,b),a.drawSVG(c,{theme:"simple"})}catch(d){}}),a("pre > code.language-flow").each(function(){try{var a=flowchart.parse(this.textContent),b=this.parentNode,c=document.createElement("div");c.className="flow-chart",b.parentNode.replaceChild(c,b),a.drawSVG(c,{"line-width":2,"font-family":"sans-serif","font-weight":"normal"})}catch(d){}})}function c(b){return this.each(function(){var c=a(this),e=c.data("likedown"),f="object"==typeof b&&b;e||c.data("likedown",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.options.postfix=this.options.postfix||this.$element.data("postfix")||"",this.init()};d.VERSION="0.0.1",d.DEFAULTS={table_class:"table table-bordered",highlighter:"highlight",help:function(){window.open("http://likedown.chiki.org/")}},d.prototype.init=function(){{var b=this.converter=new Markdown.Converter,c=this.editor=new Markdown.Editor(b,this.options.postfix,{handler:this.options.help});this.preview=document.getElementById("wmd-preview"+this.options.postfix)}Markdown.Extra.init(b,this.options),Markdown.MathJax.init(c,this.options.postfix),Markdown.Toc.init(c,this.options.postfix,this.options.toc),c.hooks.chain("onPreviewRefresh",a.proxy(this.onPreviewRefresh,this)),c.hooks.chain("onPreviewRefresh",this.onAsyncPreview),c.hooks.set("insertLinkDialog",a.proxy(this.insertLinkDialog,this)),c.hooks.set("insertImageDialog",a.proxy(this.insertImageDialog,this)),c.run(),this.initModals()},d.prototype.initModals=function(){var b=this;a(".action-insert-link").click(function(){var c=a("#input-insert-link").val();void 0!==c&&(b.insertCallback(c),b.insertCallback=void 0)}),a(".action-insert-image").click(function(){var c=a("#input-insert-image").val();void 0!==c&&(b.insertCallback(c),b.insertCallback=void 0)}),a(".modal-insert-link, .modal-insert-image").on("hidden.bs.modal",function(){void 0!==b.insertCallback&&(b.insertCallback(null),b.insertCallback=void 0)})},d.prototype.resetModalInputs=function(){a("#input-insert-link, #input-insert-image").val("")},d.prototype.insertLinkDialog=function(b){return this.insertCallback=b,this.resetModalInputs(),a(".modal-insert-link").modal(),!0},d.prototype.insertImageDialog=function(b){return this.insertCallback=b,this.resetModalInputs(),a(".modal-insert-image").modal(),!0},d.prototype.onPreviewRefresh=function(){b(document.getElementById("wmd-preview"+this.options.postfix))};var e=[Markdown.MathJax.onAsyncPreview];d.prototype.onAsyncPreview=function(){function a(b){var c=b.length?b.shift():function(){};c(function(){a(b)})}a(e.concat([function(a){a()}]))};var f=a.fn.likedown;a.fn.likedown=c,a.fn.likedown.Constructor=d,a.fn.likedown.noConflict=function(){return a.fn.likedown=f,this},a(function(){a('[data-type="likedown"]').likedown(),b(),Markdown.MathJax.onAsyncPreview()})}(jQuery);